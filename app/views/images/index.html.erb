<% content_for :title, "Album : #{@album.title}" %>
<% content_for :meta_description, "Découvrez les images de l'album #{@album.title} et ajoutez de nouvelles images pour enrichir votre collection." %>

<div class="clearfix">                
  
    <div class="container">
      <div class="row">
        <div class="col-md-9 d-flex justify-content-start">
          <h2> Album : <%= @album.title %> </h2>
        </div>
        <div class="col-md-3 d-flex align-content-end">
        <%= link_to 'Retour Aux Albums', event_albums_path(@event, @album), class: 'btn sweetButton'%>
        </div>
      </div>
    </div>


    <div class="row d-flex">
      <div class="col-md-5 d-flex align-content-center">
        <div class="upload-form-container newevent centered-form-container">
          <h2 class="form-title ">Ajoutez une Image</h2>
          <%= form_with(model: [@event, @album, Image.new], local: true, html: { multipart: true }) do |form| %>
            <div class="form-group">
              <%= form.label :image, class: 'form-label' %>
              <%= form.file_field :image, accept: 'image/*', class: 'form-control-file' %>
            </div>
            <div class="form-group">
              <%= form.label :titre, class: 'form-label' %>
              <%= form.text_field :title, class: 'form-control', placeholder: 'Titre de l\'image' %>
            </div>
            <div class="form-group">
              <%= form.label :description, class: 'form-label' %>
              <%= form.text_field :description, class: 'form-control', placeholder: 'Description de l\'image' %>
            </div>
            
            <%= form.submit 'Télécharger', class: 'btn btn-success' %>
          <% end %>
        </div>
      </div>
      <div class="col-md-6 mr-5 d-flex align-self-center justify-content-center" style="max-height: 450px; overflow-y: auto; ">
        <% if @images.empty? %>
          <h2> Vous n'avez pas encore de photo dans cet album </h2>
        <% else %>
          <div class="image-list row d-flex align-items-center">
            <% @images.each do |image| %>
              <% if image.album == @album %>
                <% attached_image = image.image %>
                <div class="col-md-3 mb-2 d-flex justify-content-center">
                  <div class="image-item text-center">
                    <a data-fancybox="gallery" href="<%= url_for(image.image) %>">
                      <%= image_tag url_for(attached_image), style: 'height: 100%; max-width: auto; ', class: 'thumbnail' %>
                    </a>
                    <div class="image-actions">
                      <%= link_to 'Voir image', event_album_image_path(@event, @album, image), class: 'btn sweetButton btn-sm' %>
                      <%= button_to 'Supprimer image', event_album_image_path(@event, @album, image), method: :delete, class: 'btn sweetButton btn-sm rounded-pill' %>
                    </div>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>    
  </div>
</div>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>
